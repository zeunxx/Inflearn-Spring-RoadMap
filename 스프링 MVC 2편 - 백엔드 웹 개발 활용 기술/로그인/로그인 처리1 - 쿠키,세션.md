## 로그인 처리 - 쿠키, 세션


### 로그인 기능

```
✅ Member Repository

public class MemberRepository {

    private static Map<Long, Member> store = new HashMap<>();
    private static long sequence = 0L;

    public Member save(Member member){
        member.setId(++sequence);
        log.info("save: member = {}",member);
        store.put(member.getId(), member);
        return member;
    }

    public  Member findById(Long id){
        return store.get(id);
    }

    public List<Member> findAll(){
        return new ArrayList<>(store.values());
    }

    public Optional<Member> findByLoginId(String loginId){
    //        List<Member> all = findAll();
    //        for (Member member : all) {
    //            if(member.getId().equals(loginId)){
    //                return Optional.of(member);
    //            }
    //        }
    //        return  Optional.empty();

        return findAll().stream()
                .filter(m->m.getLoginId().equals(loginId))
                .findFirst();
    }
}

✅ Login Service

/**
    * @return null이면 로그인 실패
    */
public Member login(String loginId, String password){

    return memberRepository.findByLoginId(loginId)
            .filter(m->m.getPassword().equals(password))
            .orElse(null);
}

✅ Login Controller

@PostMapping("/login")
public String login(@Validated @ModelAttribute LoginForm form, BindingResult bindingResult){

    if(bindingResult.hasErrors()){
        return "login/loginForm";
    }

    Member loginMember = loginService.login(form.getLoginId(), form.getPassword());

    if (loginMember == null){
        bindingResult.reject("loginFail","아이디 또는 비밀번호가 맞지 않습니다.");
        return "login/loginForm";
    }

    // 로그인 성공 처리 TODO

    return "redirect:/";
}

```