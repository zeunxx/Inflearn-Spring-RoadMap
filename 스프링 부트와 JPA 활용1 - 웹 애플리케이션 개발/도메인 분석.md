### ìš”êµ¬ì‚¬í•­ ë¶„ì„ í†µí•œ ë„ë©”ì¸ ë¶„ì„

<img width="456" alt="image" src="https://user-images.githubusercontent.com/81572478/210198929-4bd0efdf-1510-4d9f-8bc2-149d63577fa3.png">

- order - oderItem : 1ëŒ€N ê´€ê³„

     í•˜ë‚˜ì˜ ì£¼ë¬¸ ë‚´ì—ì„œ í•œ ìƒí’ˆì„ ì—¬ëŸ¬ê°œ êµ¬ë§¤í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ
- orderItem - Item : NëŒ€1 ê´€ê³„
     í•˜ë‚˜ì˜ ìƒí’ˆì„ í•œë²ˆì˜ ì£¼ë¬¸ì—ì„œ ì—¬ëŸ¬ê°œ êµ¬ë§¤í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ

    -> ì›ë˜ order - orderItem = NëŒ€N ê´€ê³„ì´ë¯€ë¡œ 1ëŒ€ë‹¤, ë‹¤ëŒ€1ë¡œ í’€ì–´ëƒ„

- category - Item : NëŒ€N ê´€ê³„
    BUT ì‹¤ì œ ì“¸ë•ŒëŠ” ìœ„ì²˜ëŸ¼ í’€ì–´ë‚´ì•¼í•¨!    


<br>

âœ… ê°€ê¸‰ì ìœ¼ë¡œëŠ” ì–‘ë°©í–¥ ê´€ê³„ë³´ë‹¨ ë‹¨ë°©í–¥ ê´€ê³„ê°€ ì¢‹ìŒ!

ì°¸ê³ : íšŒì›ì´ ì£¼ë¬¸ì„ í•˜ê¸° ë•Œë¬¸ì—, íšŒì›ì´ ì£¼ë¬¸ë¦¬ìŠ¤íŠ¸ë¥¼ ê°€ì§€ëŠ” ê²ƒì€ ì–¼í• ë³´ë©´ ì˜ ì„¤ê³„í•œ ê²ƒ ê°™ì§€ë§Œ, ê°ì²´
ì„¸ìƒì€ ì‹¤ì œ ì„¸ê³„ì™€ëŠ” ë‹¤ë¥´ë‹¤. 

ì‹¤ë¬´ì—ì„œëŠ” íšŒì›ì´ ì£¼ë¬¸ì„ ì°¸ì¡°í•˜ì§€ ì•Šê³ , ì£¼ë¬¸ì´ íšŒì›ì„ ì°¸ì¡°í•˜ëŠ” ê²ƒìœ¼ë¡œ
ì¶©ë¶„í•˜ë‹¤.

â¡ï¸ ì£¼ë¬¸ì„ ìƒì„±í• ë•Œ íšŒì› ì •ë³´ê°€ í•„ìš”í•œ ê²ƒ! ë”°ë¼ì„œ ORDERê°€ MEMBERë¥¼ ì°¸ì¡°!

<br><br>

### íšŒì› í…Œì´ë¸” ë¶„ì„

<img width="457" alt="image" src="https://user-images.githubusercontent.com/81572478/210199369-09d7c47b-9e92-4e89-b3a9-55705389d5b9.png">

- ì¹´í…Œê³ ë¦¬ì™€ ì•„ì´í…œ
    - categoryì™€ itemì€ ìœ„ì—ì„œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ì˜€ìŒ
    - but ê´€ê³„í˜•DBì—ì„  ê·¸ ê´€ê³„ë¥¼ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ë¡œ í’€ì–´ë‚´ì•¼í•¨ 
    - ë”°ë¼ì„œ, category_item í…Œì´ë¸”ì„ ì¶”ê°€

<br><Br>

### ì—°ê´€ê´€ê³„ ë§µí•‘ ë¶„ì„

- íšŒì›ê³¼ ì£¼ë¬¸: ì¼ëŒ€ë‹¤ , ë‹¤ëŒ€ì¼ì˜ ì–‘ë°©í–¥ ê´€ê³„. ë”°ë¼ì„œ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì„ ì •í•´ì•¼ í•˜ëŠ”ë°, ì™¸ë˜ í‚¤ê°€ ìˆëŠ”
ì£¼ë¬¸ì„ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ

    - ê·¸ëŸ¬ë¯€ë¡œ Order.member ë¥¼ ORDERS.MEMBER_ID ì™¸ë˜
í‚¤ì™€ ë§¤í•‘
    -> ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìª½ì—ì„œ ê°’ì„ settingí•´ì•¼ ê°’ì´ ë³€ê²½ë¨ 
    â¡ï¸ memberìª½ì—ì„œì˜ orderëŠ” ì¡°íšŒë§Œ ê°€ëŠ¥

    <br>

- ì£¼ë¬¸ìƒí’ˆê³¼ ì£¼ë¬¸: ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ ê´€ê³„. ì™¸ë˜ í‚¤ê°€ ì£¼ë¬¸ìƒí’ˆì— ìˆìœ¼ë¯€ë¡œ ì£¼ë¬¸ìƒí’ˆì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸. 
ê·¸ëŸ¬ë¯€ë¡œ OrderItem.order ë¥¼ ORDER_ITEM.ORDER_ID ì™¸ë˜ í‚¤ì™€ ë§¤í•‘
    - order_item í…Œì´ë¸”ì˜ order_idê°€ ì™¸ë˜í‚¤ê°€ ë˜ì–´ orderë¥¼ ë§µí•‘

    <br>

- ì£¼ë¬¸ìƒí’ˆê³¼ ìƒí’ˆ: ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ ê´€ê³„. OrderItem.item ì„ ORDER_ITEM.ITEM_ID ì™¸ë˜ í‚¤ì™€
ë§¤í•‘
    - itemì€ orderItemì„ ì°¸ì¡°í•  í•„ìš”ê°€ ì—†ìŒ! ë”°ë¼ì„œ, orderItemë§Œ itemì„ ì™¸ë˜í‚¤ë¡œ ì°¸ì¡°


<br>

- ì£¼ë¬¸ê³¼ ë°°ì†¡: ì¼ëŒ€ì¼ ì–‘ë°©í–¥ ê´€ê³„. Order.delivery ë¥¼ ORDERS.DELIVERY_ID ì™¸ë˜ í‚¤ì™€ ë§¤í•‘
    - ì¼ëŒ€ì¼ ê´€ê³„ì´ë¯€ë¡œ ì£¼ë¬¸/ë°°ì†¡ ì–´ëŠìª½ì— ì™¸ë˜í‚¤ë¥¼ ë†“ì„ì§€ëŠ” ê°œë°œì ë§ˆìŒ? ê·¼ë° ì£¼ë¬¸ì— ë†“ëŠ” ê²ƒì´ ì¼ë°˜ì ì¼ê²ƒ ê°™ìŒ ..


<br>

ğŸ“Œ ì°¸ê³ : ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ê³³ì„ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•´ë¼.
> ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ ë‹¨ìˆœíˆ ì™¸ë˜ í‚¤ë¥¼ ëˆ„ê°€ ê´€ë¦¬í•˜ëƒì˜ ë¬¸ì œì´ì§€ ë¹„ì¦ˆë‹ˆìŠ¤ìƒ ìš°ìœ„ì— ìˆë‹¤ê³  ì£¼ì¸ìœ¼ë¡œ ì •í•˜ë©´
ì•ˆëœë‹¤.. ì˜ˆë¥¼ ë“¤ì–´ì„œ ìë™ì°¨ì™€ ë°”í€´ê°€ ìˆìœ¼ë©´, ì¼ëŒ€ë‹¤ ê´€ê³„ì—ì„œ í•­ìƒ ë‹¤ìª½ì— ì™¸ë˜ í‚¤ê°€ ìˆìœ¼ë¯€ë¡œ ì™¸ë˜ í‚¤ê°€
ìˆëŠ” ë°”í€´ë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•˜ë©´ ëœë‹¤. ë¬¼ë¡  ìë™ì°¨ë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥ í•œ
ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ìë™ì°¨ë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ì •í•˜ë©´ ìë™ì°¨ê°€ ê´€ë¦¬í•˜ì§€ ì•ŠëŠ” ë°”í€´ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ ê°’ì´
ì—…ë°ì´íŠ¸ ë˜ë¯€ë¡œ ê´€ë¦¬ì™€ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë µê³ , ì¶”ê°€ì ìœ¼ë¡œ ë³„ë„ì˜ ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ê°€ ë°œìƒí•˜ëŠ” ì„±ëŠ¥ ë¬¸ì œë„
ìˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ JPA ê¸°ë³¸í¸ì„ ì°¸ê³ í•˜ì


<br><Br>

### JPA ë‚´ì¥ íƒ€ì…
- @Embeddable
    : Embeddable = ì´ í´ë˜ìŠ¤ëŠ” í´ë˜ìŠ¤ì— í¬í•¨ë  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜
    - Memberì˜ ì •ë³´ì¤‘ì— "ì£¼ì†Œ"ë¥¼ í‘œí˜„í•˜ëŠ” ì¹¼ëŸ¼ë“¤ì´ ìˆìœ¼ë¯€ë¡œ, ì—¬ê¸°ì„œ "ì£¼ì†Œ"ë¼ëŠ” ê°ì²´ë¡œ ë¬¶ì–´ì„œ ê´€ë¦¬


```
    @Entity
    @Getter @Setter
    public class Member {
        @Id
        @GeneratedValue
        @Column(name="member_id")
        private Long Id;

        private String name;

        private Address address;

        private List<Order> orders = new ArrayList<>();
    }

```

```
    @Embeddable
    public class Address {

        private String city;
        private String street;
        private String zipcode;
    }

```

<Br><Br>

### member - orderì˜ ê´€ê³„

#### 1. Member

```
public class Member {
    @Id
    @GeneratedValue
    @Column(name="member_id")
    private Long Id;

    private String name;

    @Embedded // ìƒëµ ê°€ëŠ¥
    private Address address;

    @OneToMany(mappedBy = "member")
    private List<Order> orders = new ArrayList<>();
}
```

- Memberì™€ orderëŠ” 1ëŒ€ë‹¤ ê´€ê³„
ë”°ë¼ì„œ memberì—ê²Œ orderëŠ” ***ë‹¤*** ì´ë¯€ë¡œ OneToMany

- (mappedBy = "member") : order í…Œì´ë¸”ì— ìˆëŠ” member í•„ë“œì— ë§µí•‘**ëœ** ê²ƒ ë‚˜íƒ€ëƒ„(ì£¼ì¸ì´ ì•„ë‹Œ ì• ë“¤ì´ í‘œì‹œ)

#### 2. Order

```
public class Order {

    @Id
    @GeneratedValue
    @Column(name="order_id")
    private Long id;

    @ManyToOne
    @JoinColumn(name="member_id")
    private Member member;

}
```

- Orderì™€ MemberëŠ” ë‹¤ëŒ€ì¼ ê´€ê³„
ë”°ë¼ì„œ orderì—ê²Œ memberëŠ” ***1*** ì´ë¯€ë¡œ ManyToOne
- @JoinColumn(name="member_id") : ì™¸ë˜í‚¤ ì´ë¦„ = member_id (ì£¼ì¸ì¸ ìª½ì´ ì‘ì„±, ì™¸ë˜í‚¤ ìˆìœ¼ë‹ˆê¹Œ)

<br>

#### 3. Memberì™€ OrderëŠ” ì¼ëŒ€ë‹¤ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„
- ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì„ ì„¤ì •í•´ì•¼í•¨!
- foreign keyì˜ ê°’ì„ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê°ì²´(ì£¼ì¸)ëŠ” ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ì„ íƒí•´ì•¼í•¨
- í˜„ì¬ëŠ” ORDER í…Œì´ë¸”ì— member_id ì™¸ë˜í‚¤ê°€ ìˆìŒ
    = orderê°€ ì—°ê´€ê´€ê³„ ì£¼ì¸!

â• ì•ˆê·¸ëŸ¬ë©´ memberì˜ ë­”ê°€ë¥¼ ë°”ê¿¨ëŠ”ë° orderí…Œì´ë¸”ì´ ì—…ë°ì´íŠ¸ ë¨


<br><Br>

### Itemì˜ ìƒì†ê´€ê³„
- Itemë‚´ì—ëŠ” book, movie, albumì´ ìƒì†ê´€ê³„ë¡œ ìˆìŒ
```
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name="dtype")
@Getter @Setter
public abstract class Item {

    @Id
    @GeneratedValue
    @Column(name="item_id")
    private Long id;

    private String name;
    private int price;
    private int stockQuantity; //ì—¬ê¸°ê¹Œì§„ ê³µë™ ì†ì„±
}
```

```
@Entity
@DiscriminatorValue("B")
@Getter
@Setter
public class Book extends Item{
    private String author;
    private String isbn;
}

```

- Itemì€ ì‹±ê¸€ í…Œì´ë¸”ë¡œ í•œë²ˆì— ë‹¤ í•œ í…Œì´ë¸”ì— ë„£ì„ê±°ì„

    â¡ï¸ @Inheritance(strategy = InheritanceType.SINGLE_TABLE)
<img width="112" alt="image" src="https://user-images.githubusercontent.com/81572478/210203247-d60228b7-f2a3-436c-92f0-264aa77c28f1.png">

- Itemì„ DBì— ë„£ì„ë•Œ ì–´ë–¤ íƒ€ì…ì¸ì§€ êµ¬ë¶„í•´ì•¼í•˜ë‹ˆê¹Œ

    â¡ï¸ @DiscriminatorColumn(name="dtype")
    : ë¶€ëª¨ í´ë˜ìŠ¤ì— ì„ ì–¸. í•˜ìœ„ í´ë˜ìŠ¤ë¥¼ êµ¬ë¶„í•˜ëŠ” ìš©ë„ì˜ ì»¬ëŸ¼

    â¡ï¸ @DiscriminatorValue("B")
    
    : book íƒ€ì…ì´ë©´ Bë¡œ êµ¬ë¶„í•œë‹¤ëŠ” ëœ»

â• ì£¼ì˜

- ë¶€ëª¨ í´ë˜ìŠ¤ëŠ” ì¶”ìƒí´ë˜ìŠ¤ë¡œ ì„ ì–¸
- ìì‹ í´ë˜ìŠ¤ì— @Id ë„£ìœ¼ë©´ ì•ˆë¨
- ë¶€ëª¨ í´ë˜ìŠ¤ë¡œ Repository ë§Œë“¤ í•„ìš” ì—†ìŒ

<Br><Br>

### orderì™€ delivery ê´€ê³„
- ì¼ëŒ€ì¼ ì–‘ë°©í–¥ ê´€ê³„

#### 1. order
```
@Entity
@Table(name="orders")
@Getter @Setter
public class Order {
    ...
    
    @OneToOne
    @JoinColumn(name="delivery_id")
    private Delivery delivery;

    ...
}

```


- ë°°ì†¡ë³´ë‹¤ ì£¼ë¬¸ì„ ë” ë§ì´ ì¡°íšŒí•˜ë¯€ë¡œ ì£¼ë¬¸ìª½ì— ì™¸ë˜í‚¤ ì„¤ì •
- orderëŠ” delivey_idë¥¼ foreign keyë¡œ ì¡ê³  ì—°ê´€ê´€ê³„ ì£¼ì¸ì´ ë¨

#### 2. delivery
```
@Entity
@Getter @Setter
public class Delivery {
    ...

    @OneToOne(mappedBy = "delivery")
    private Order order;

    ...

    @Enumerated(EnumType.STRING)
    private DeliveryStatus status; //ë°°ì†¡ìƒíƒœ [READY, COMP]
}
```

- deliveryëŠ” ê±°ìš¸ì´ ë˜ì–´ ì¡°íšŒë§Œ ê°€ëŠ¥, order í…Œì´ë¸”ì˜ deliveryë¡œ ì¡°íšŒ (mappedBy = "delivery")

âœ… enum ì‚¬ìš©ì‹œ  @Enumerated(EnumType.STRING) : stringìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê¶Œì¥!!(ìˆ«ìë¡œ í–ˆë‹¤ê°€ ë‚˜ì¤‘ì— ìƒˆë¡œìš´ íƒ€ì… ì¶”ê°€ì‹œ ê¼¬ì¼ ìˆ˜ ìˆìŒ)