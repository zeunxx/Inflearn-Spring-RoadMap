## HTTP ìš”ì²­

### HTTP ìš”ì²­ - ê¸°ë³¸, í—¤ë” ì¡°íšŒ
```
    @RequestMapping("/headers")
    public String headers(HttpServletRequest request,
                          HttpServletResponse response,
                          HttpMethod httpMethod,
                          Locale locale,
                          @RequestHeader MultiValueMap<String, String> headerMap,
                          @RequestHeader("host") String host,
                          @CookieValue(value = "myCookie", required = false) String cookie){
        log.info("request={}", request);
        log.info("response={}", response);
        log.info("httpMethod={}", httpMethod);
        log.info("locale={}", locale);
        log.info("headerMap={}", headerMap);
        log.info("header host={}", host);
        log.info("myCookie={}", cookie);
        return "ok";
    }
```

- HttpServletRequest
- HttpServletResponse
- HttpMethod : HTTP ë©”ì„œë“œë¥¼ ì¡°íšŒí•œë‹¤. org.springframework.http.HttpMethod
- Locale : Locale ì •ë³´ë¥¼ ì¡°íšŒí•œë‹¤.
- @RequestHeader MultiValueMap<String, String> headerMap
    - ëª¨ë“  HTTP í—¤ë”ë¥¼ MultiValueMap í˜•ì‹ìœ¼ë¡œ ì¡°íšŒí•œë‹¤.
- @RequestHeader("host") String host
    - íŠ¹ì • HTTP í—¤ë”ë¥¼ ì¡°íšŒí•œë‹¤.
    - ì†ì„±
        - í•„ìˆ˜ ê°’ ì—¬ë¶€: required
        - ê¸°ë³¸ ê°’ ì†ì„±: defaultValue
- @CookieValue(value = "myCookie", required = false) String cookie
    - íŠ¹ì • ì¿ í‚¤ë¥¼ ì¡°íšŒí•œë‹¤.
    - ì†ì„±
        - í•„ìˆ˜ ê°’ ì—¬ë¶€: required
        - ê¸°ë³¸ ê°’: defaultValue
<br>

> MultiValueMap

> MAPê³¼ ìœ ì‚¬í•œë°, í•˜ë‚˜ì˜ í‚¤ì— ì—¬ëŸ¬ ê°’ì„ ë°›ì„ ìˆ˜ ìˆë‹¤.
HTTP header, HTTP ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì™€ ê°™ì´ í•˜ë‚˜ì˜ í‚¤ì— ì—¬ëŸ¬ ê°’ì„ ë°›ì„ ë•Œ ì‚¬ìš©í•œë‹¤. 
> ex)  keyA=value1&keyA=value

```
MultiValueMap<String, String> map = new LinkedMultiValueMap();
map.add("keyA", "value1");
map.add("keyA", "value2");
//[value1,value2]
List<String> values = map.get("keyA");
```

<br><Br>

### HTTP ìš”ì²­ íŒŒë¼ë¯¸í„° - ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°, HTML Form

1ï¸âƒ£ http ìš”ì²­ ë°ì´í„° ì¡°íšŒ - ê°œìš”

- í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ìš”ì²­ ë°ì´í„°ë¥¼ ì „ë‹¬í• ë•Œ ì‚¬ìš©í•˜ëŠ” 3ê°€ì§€ ë°©ë²•

1. GET - ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°
    - /url?username=hello&age=20
    - ë©”ì‹œì§€ ë°”ë”” ì—†ì´, URLì˜ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì— ë°ì´í„°ë¥¼ í¬í•¨í•´ì„œ ì „ë‹¬
    - ì˜ˆ) ê²€ìƒ‰, í•„í„°, í˜ì´ì§•ë“±ì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
2. POST - HTML Form
    - content-type: application/x-www-form-urlencoded
    - ë©”ì‹œì§€ ë°”ë””ì— ì¿¼ë¦¬ íŒŒë¦¬ë¯¸í„° í˜•ì‹ìœ¼ë¡œ ì „ë‹¬ username=hello&age=20
    - ì˜ˆ) íšŒì› ê°€ì…, ìƒí’ˆ ì£¼ë¬¸, HTML Form ì‚¬ìš©
3. HTTP message bodyì— ë°ì´í„°ë¥¼ ì§ì ‘ ë‹´ì•„ì„œ ìš”ì²­
    - HTTP APIì—ì„œ ì£¼ë¡œ ì‚¬ìš©, JSON, XML, TEXT
    - ë°ì´í„° í˜•ì‹ì€ ì£¼ë¡œ JSON ì‚¬ìš©
    - POST, PUT, PATCH

<br>

### 1ï¸âƒ£ ìš”ì²­ íŒŒë¼ë¯¸í„° - ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°, HTML Form

**GET, ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì „ì†¡**
`http://localhost:8080/request-param?username=hello&age=20`

<br>

**POST, HTML Form ì „ì†¡**
```
POST /request-param ...
content-type: application/x-www-form-urlencoded

username=hello&age=20
```

â¡ï¸ GET ì¿¼ë¦¬ íŒŒë¦¬ë¯¸í„° ì „ì†¡ ë°©ì‹ì´ë“ , POST HTML Form ì „ì†¡ ë°©ì‹ì´ë“  ë‘˜ë‹¤ í˜•ì‹ì´ ê°™ìœ¼ë¯€ë¡œ êµ¬ë¶„ì—†ì´
ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

ì´ê²ƒì„ ê°„ë‹¨íˆ **ìš”ì²­ íŒŒë¼ë¯¸í„°(request parameter) ì¡°íšŒ**ë¼ í•œë‹¤

```
@Slf4j
@Controller
public class RequestParamController {

    @RequestMapping("/request-param-v1")
    public void requestParamV1(HttpServletRequest request, HttpServletResponse response) throws IOException {
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age"));

        log.info("username ={}, age ={}", username, age);

        response.getWriter().write("ok");
    }
}

```

<br>

### 2ï¸âƒ£ ìš”ì²­ íŒŒë¼ë¯¸í„° - @RequestParam

```
    @ResponseBody
    @RequestMapping("/request-param-v2")
    public String requestParamV2(@RequestParam("username") String memberName,
                                 @RequestParam("age") int memberAge){
        log.info("username={}, age={}", memberName, memberAge);
        return "ok";
    }

    @ResponseBody
    @RequestMapping("/request-param-v3")
    public String requestParamV3(@RequestParam String username,
                                 @RequestParam int age){
        log.info("username={}, age={}", username, age);
        return "ok";
    }

    @ResponseBody
    @RequestMapping("/request-param-v4")
    public String requestParamV4(String username,int age){
        log.info("username={}, age={}", username, age);
        return "ok";
    }
```

- @RequestParam : íŒŒë¼ë¯¸í„° ì´ë¦„ìœ¼ë¡œ ë°”ì¸ë”©
- @ResponseBody : View ì¡°íšŒë¥¼ ë¬´ì‹œí•˜ê³ , HTTP message bodyì— ì§ì ‘ í•´ë‹¹ ë‚´ìš© ì…ë ¥
- String , int , Integer ë“±ì˜ ë‹¨ìˆœ íƒ€ì…ì´ë©´ @RequestParam ë„ ìƒëµ ê°€ëŠ¥

<br>

> ì£¼ì˜
> @RequestParam ì• ë…¸í…Œì´ì…˜ì„ ìƒëµí•˜ë©´ ìŠ¤í”„ë§ MVCëŠ” ë‚´ë¶€ì—ì„œ required=false ë¥¼ ì ìš©í•œë‹¤.
required ì˜µì…˜ì€ ë°”ë¡œ ë‹¤ìŒì— ì„¤ëª…í•œë‹¤.

<br>


> ì°¸ê³ 
> ì´ë ‡ê²Œ ì• ë…¸í…Œì´ì…˜ì„ ì™„ì „íˆ ìƒëµí•´ë„ ë˜ëŠ”ë°, ë„ˆë¬´ ì—†ëŠ” ê²ƒë„ ì•½ê°„ ê³¼í•˜ë‹¤ëŠ” ì£¼ê´€ì  ìƒê°ì´ ìˆë‹¤.
> @RequestParam ì´ ìˆìœ¼ë©´ ëª…í™•í•˜ê²Œ ìš”ì²­ íŒŒë¦¬ë¯¸í„°ì—ì„œ ë°ì´í„°ë¥¼ ì½ëŠ” ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

<br>

#### ğŸ’¡ íŒŒë¼ë¯¸í„° í•„ìˆ˜ ì—¬ë¶€

```
    @ResponseBody
    @RequestMapping("/request-param-required")
    public String requestParamRequired(@RequestParam(required = true) String username, //ë°˜ë“œì‹œ í•„ìš”í•œ íŒŒë¼ë¯¸í„°
                                       @RequestParam(required = false) Integer age){
        log.info("username={}, age={}", username, age);
        return "ok";
    }
```

- @RequestParam.required
    - íŒŒë¼ë¯¸í„° í•„ìˆ˜ ì—¬ë¶€
    - ê¸°ë³¸ê°’ì´ íŒŒë¼ë¯¸í„° í•„ìˆ˜( true )ì´ë‹¤.
- /request-param ìš”ì²­
    - username ì´ ì—†ìœ¼ë¯€ë¡œ 400 ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.
- **ì£¼ì˜! - íŒŒë¼ë¯¸í„° ì´ë¦„ë§Œ ì‚¬ìš©**
    - /request-param?username=
    - íŒŒë¼ë¯¸í„° ì´ë¦„ë§Œ ìˆê³  ê°’ì´ ì—†ëŠ” ê²½ìš° ë¹ˆë¬¸ìë¡œ í†µê³¼
- **ì£¼ì˜! - ê¸°ë³¸í˜•(primitive)ì— null ì…ë ¥**
    - /request-param ìš”ì²­
    - @RequestParam(required = false) int age
    - null ì„ int ì— ì…ë ¥í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥(500 ì˜ˆì™¸ ë°œìƒ)
    - ë”°ë¼ì„œ null ì„ ë°›ì„ ìˆ˜ ìˆëŠ” Integer ë¡œ ë³€ê²½í•˜ê±°ë‚˜, ë˜ëŠ” ë‹¤ìŒì— ë‚˜ì˜¤ëŠ” defaultValue ì‚¬ìš©

<br>

```
    @ResponseBody
    @RequestMapping("/request-param-default")
    public String requestParamDefault(@RequestParam(required = true, defaultValue = "guest") String username,
                                       @RequestParam(required = false, defaultValue = "-1") int age){
        log.info("username={}, age={}", username, age);
        return "ok";
    }
```
- username=hello, age=20
- username=guest, age=-1 (íŒŒë¼ë¯¸í„° ì•ˆë„˜ê²¼ì„ë•Œ, ê¸°ë³¸ê°’ ì ìš©)
- defaultValue ëŠ” ë¹ˆ ë¬¸ìì˜ ê²½ìš°ì—ë„ ì„¤ì •í•œ ê¸°ë³¸ ê°’ì´ ì ìš©ëœë‹¤.
    - /request-param-default?username=

<br>

#### ğŸ’¡ íŒŒë¼ë¯¸í„° MAPìœ¼ë¡œ ì¡°íšŒí•˜ê¸° - requestParamMap
```
@ResponseBody
@RequestMapping("/request-param-map")
public String requestParamMap(@RequestParam Map<String, Object> paramMap){
    log.info("username={}, age={}", paramMap.get("username"), paramMap.get("age"));
    return "ok";
}
```
íŒŒë¼ë¯¸í„°ë¥¼ Map, MultiValueMapìœ¼ë¡œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤. 

- @RequestParam Map , 
    - Map(key=value)
- @RequestParam MultiValueMap
    - MultiValueMap(key=[value1, value2, ...] ex) (key=userIds, value=[id1, id2])

<br>
â¡ï¸ íŒŒë¼ë¯¸í„°ì˜ ê°’ì´ 1ê°œê°€ í™•ì‹¤í•˜ë‹¤ë©´ Map ì„ ì‚¬ìš©í•´ë„ ë˜ì§€ë§Œ, ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ MultiValueMap ì„ ì‚¬ìš©í•˜ì.

+ ê·¼ë° ì›¬ë§Œí•˜ë©´ íŒŒë¼ë¯¸í„° ê°’ì€ 1ê°œë¥¼ ì”€