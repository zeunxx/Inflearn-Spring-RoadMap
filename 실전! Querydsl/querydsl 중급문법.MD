## ì¤‘ê¸‰ ë¬¸ë²•

### í”„ë¡œì ì…˜ê³¼ ê²°ê³¼ ë°˜í™˜ - ê¸°ë³¸

- í”„ë¡œì ì…˜: select ëŒ€ìƒ ì§€ì •

âœ… **í”„ë¡œì ì…˜ ëŒ€ìƒì´ í•˜ë‚˜**
```

List<String> result = queryFactory
                .select(member.username)
                .from(member)
                .fetch();

```

- í”„ë¡œì ì…˜ ëŒ€ìƒì´ í•˜ë‚˜ë©´ íƒ€ì…ì„ ëª…í™•íˆ ì§€ì •í•  ìˆ˜ ìˆìŒ (List<String>)
- í”„ë¡œì ì…˜ ëŒ€ìƒì´ ë‘˜ ì´ìƒì´ë©´ íŠœí”Œì´ë‚˜ DTOë¡œ ì¡°íšŒ!

<BR>


âœ… **íŠœí”Œ ì¡°íšŒ**
í”„ë¡œì ì…˜ ëŒ€ìƒì´ ë‘˜ ì´ìƒì¼ë•Œ ì‚¬ìš©
```
    List<Tuple> result = queryFactory.select(member.username, member.age)
                .from(member)
                .fetch();

    for (Tuple tuple : result) {
        String username = tuple.get(member.username);
        Integer age = tuple.get(member.age);
    }


```
- íŠœí”Œì€ repositoryë‚´ì—ì„œë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê¶Œì¥
- repository ì™¸ì—ì„œ ì“¸ë• dtoë¡œ ë³€í™˜í•˜ëŠ” ê²ƒì´ ì¢‹ìŒ

<br>

âœ… **DTO ì¡°íšŒ**

1ï¸âƒ£ ìˆœìˆ˜ JPAì—ì„œ DTO ì¡°íšŒ ì½”ë“œ
```
    List<MemberDto> result =
                em.createQuery("select new study.querydsl.dto.MemberDto(m.username, m.age) from Member m ", MemberDto.class)
                .getResultList();
```
- ìˆœìˆ˜ JPAì—ì„œ DTOë¥¼ ì¡°íšŒí• ë•ŒëŠ” new ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ì•¼ í•¨
- DTOì˜ package ì´ë¦„ì„ ë‹¤ ì ì–´ì•¼ í•´ì„œ ì§€ì €ë¶„í•¨
- ìƒì„±ì ë°©ì‹ë§Œ ì§€ì›!

<br>

2ï¸âƒ£ **querydsl ë¹ˆ ìƒì„±(Bean population)**

ê²°ê³¼ë¥¼ DTO ë°˜í™˜í• ë•Œ ì‚¬ìš©

- í”„ë¡œí¼í‹° ì ‘ê·¼ ë°©ë²•
- í•„ë“œ ì§ì ‘ ì ‘ê·¼ ë°©ë²•
- ìƒì„±ì ì‚¬ìš© ë°©ë²•

<br>

```
ğŸ’¡ í”„ë¡œí¼í‹° ì ‘ê·¼ - Setter

    List<MemberDto> result = queryFactory
                .select(Projections.bean(MemberDto.class,
                        member.username,
                        member.age))
                .from(member)
                .fetch();

    // MemberDto í´ë˜ìŠ¤ ë‚´ì— getter, setter í•„ìš”

ğŸ’¡ í•„ë“œ ì§ì ‘ ì ‘ê·¼

    List<MemberDto> result = queryFactory
                .select(Projections.fields(MemberDto.class,
                        member.username,
                        member.age))
                .from(member)
                .fetch();

    // MemberDto í´ë˜ìŠ¤ ë‚´ì— getter, setter í•„ìš” ì—†ìŒ, í•„ë“œì— ë°”ë¡œ ê°’ ë„£ìŒ

ğŸ’¡ ìƒì„±ì ì‚¬ìš©

    List<MemberDto> result = queryFactory
                .select(Projections.constructor(MemberDto.class,
                        member.username,
                        member.age)) // MemberDtoì˜ ìƒì„±ì ìˆœì„œì™€ ì¼ì¹˜í•´ì•¼ í•¨
                .from(member)
                .fetch();

     â¡ï¸ì´ë¦„ì´ ì•„ë‹Œ íƒ€ì…(String, int ë“±)ìœ¼ë¡œ ë“¤ì–´ê°€ë¯€ë¡œ ë³„ì¹­ì´ ë‹¬ë¼ë„ ìƒê´€ì—†ìŒ


â• ë³„ì¹­ì´ ë‹¤ë¥¼ ë•Œ!

    //UserDtoëŠ” nameì¸ë° ë³„ì¹­ì´ usernameì´ë¼ ë‹¬ë¼ì„œ nullë¡œ ë“¤ì–´ê°

    List<UserDto> result = queryFactory
                .select(Projections.fields(UserDto.class,
                        member.username.as("name"), //UserDtoëŠ” nameì¸ë° ë³„ì¹­ì´ usernameì´ë¼ ë‹¬ë¼ì„œ nullë¡œ ë“¤ì–´ê°
                        member.age))
                .from(member)
                .fetch();


    List<UserDto> result2 = queryFactory
                .select(Projections.fields(UserDto.class,
                        member.username.as("name"), //UserDtoì˜ name

                        ExpressionUtils.as(JPAExpressions //UserDtoì˜ age(ì„œë¸Œì¿¼ë¦¬ ë³„ì¹­ ìƒì„±)
                                .select(memberSub.age.max())
                                .from(memberSub), "age")
                ))
                .from(member)
                .fetch();

```
- í”„ë¡œí¼í‹°ë‚˜ í•„ë“œ ì ‘ê·¼ ìƒì„± ë°©ì‹ì—ì„œ ì´ë¦„ì´ ë‹¤ë¥¼ë•Œ í•´ê²°ë°©ì•ˆ
- `ExpressionUtils.as(source, alias)`: í•„ë“œë‚˜ ì„œë¸Œì¿¼ë¦¬ì— ë³„ì¹­ ì ìš©
- `username.as("memberName")`: í•„ë“œì— ë³„ì¹­ ì ìš©

<br><Br>

### í”„ë¡œì ì…˜ê³¼ ê²°ê³¼ ë°˜í™˜ - @QueryProjection

âœ… ìƒì„±ì + @QueryProjection

```
- MemberDto.class

public class MemberDto {

    private String username;
    private int age;

    @QueryProjection
    public MemberDto(String username, int age) {
        this.username = username;
        this.age = age;
    }
}


- repository

List<MemberDto> result = queryFactory
            .select(new QMemberDto(member.username, member.age))
            .from(member)
            .fetch();

â¡ï¸ ì»´íŒŒì¼ ì‹œì ì— ì˜¤ë¥˜ ë°”ë¡œ í™•ì¸ ê°€ëŠ¥!

```

ì´ ë°©ë²•ì€ ì»´íŒŒì¼ëŸ¬ë¡œ íƒ€ì…ì„ ì²´í¬í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ê°€ì¥ ì•ˆì „í•œ ë°©ë²•

ë‹¤ë§Œ DTOì— QueryDSL ì–´ë…¸í…Œì´ì…˜ì„ ìœ ì§€í•´ì•¼ í•˜ëŠ” ì ê³¼ DTOê¹Œì§€ Q íŒŒì¼ì„ ìƒì„±í•´ì•¼ í•˜ëŠ” ë‹¨ì ì´ ì¡´ì¬!
- dto í´ë˜ìŠ¤ê°€ querydslì— ëŒ€í•œ ì˜ì¡´ì„±ì´ ìƒê¸°ê²Œ ë¨
- dtoê°€ ìˆœìˆ˜í•˜ì§€ ì•ŠìŒ

<br>

**distinct**

```
List<String> result = queryFactory
    .select(member.username).distinct()
    .from(member)
    .fetch();

```
> ì°¸ê³ : distincyëŠ” JPQLì˜ distinctì™€ ê°™ìŒ